<!-- 目次 -->
<a id="Index"></a>

- [1.システム概要](#1システム概要)
  - [1.1 実行環境](#11-実行環境)
- [2.システム設計](#2システム設計)
- [2.1.システム構成図](#21システム構成図)
    - [機能一覧](#機能一覧)
- [3. 機能設計](#3-機能設計)
  - [3.1 ユースケース検討](#31-ユースケース検討)
    - [3.1.1 ファイルへの操作](#311-ファイルへの操作)
    - [3.1.2 ファイル操作の組み合わせ](#312-ファイル操作の組み合わせ)
    - [3.1.3 ユースケースごとの処理](#313-ユースケースごとの処理)
      - [3.1.3.1 ユースケースの識別](#3131-ユースケースの識別)
      - [3.1.3.2 同期処理](#3132-同期処理)
      - [3.1.3.3 コンフリクト処理](#3133-コンフリクト処理)
      - [3.1.3.4 検出](#3134-検出)
        - [リポジトリの変更履歴の取得](#リポジトリの変更履歴の取得)
        - [リポジトリ間の差分情報の取得](#リポジトリ間の差分情報の取得)
        - [リポジトリの情報とユースケースの検出の対応付け表](#リポジトリの情報とユースケースの検出の対応付け表)
  - [3.2 機能設計](#32-機能設計)
        - [フローチャート](#フローチャート)
    - [3.2.1 検出処理](#321-検出処理)
    - [3.2.2 マージ処理](#322-マージ処理)
    - [3.2.3 (TBD)コンフリクト処理](#323-tbdコンフリクト処理)
- [4.データ設計](#4データ設計)
  - [4.1 外部ファイルサイズ制約](#41-外部ファイルサイズ制約)
  - [4.2 データ定義](#42-データ定義)
    - [4.2.1 構成情報](#421-構成情報)
    - [4.2.2 コンフリクト情報](#422-コンフリクト情報)
      - [4.2.2.1 コンフリクト発生ケースとコンフリクト情報の対応](#4221-コンフリクト発生ケースとコンフリクト情報の対応)
    - [4.2.3 設定情報](#423-設定情報)
  - [4.3 帳票設計](#43-帳票設計)
    - [4.3.1 設定情報ファイルレイアウト設計](#431-設定情報ファイルレイアウト設計)
      - [4.3.1.1 シリアライズフォーマット](#4311-シリアライズフォーマット)
      - [4.3.1.2 情報の記載法](#4312-情報の記載法)
    - [4.3.2 構成情報ファイルレイアウト設計](#432-構成情報ファイルレイアウト設計)
      - [4.3.2.1 シリアライズフォーマット](#4321-シリアライズフォーマット)
      - [4.3.2.2 情報の記載法](#4322-情報の記載法)
    - [4.3.3 変更履歴情報ファイル](#433-変更履歴情報ファイル)
      - [4.3.3.1 シリアライズフォーマット](#4331-シリアライズフォーマット)
      - [4.3.3.2 情報の記載法](#4332-情報の記載法)
    - [4.3.4 ログファイル](#434-ログファイル)
      - [4.3.4.1 シリアライズフォーマット](#4341-シリアライズフォーマット)
      - [4.3.4.2 情報の記載法](#4342-情報の記載法)
- [5.インターフェイス設計](#5インターフェイス設計)
  - [5.1.管理機能API](#51管理機能api)
    - [5.1.1.同期開始](#511同期開始)
  - [5.2.差分検出機能](#52差分検出機能)
    - [5.2.1.リポジトリ差分検出](#521リポジトリ差分検出)
    - [5.2.2.構成情報差分検出](#522構成情報差分検出)
  - [5.3.同期処理機能API](#53同期処理機能api)
    - [5.3.1.ファイル追加同期処理](#531ファイル追加同期処理)
    - [5.3.2.ファイル削除同期処理](#532ファイル削除同期処理)
    - [5.3.3.ファイル変更同期処理](#533ファイル変更同期処理)
    - [5.3.4.ファイル同時追加同期処理](#534ファイル同時追加同期処理)
    - [5.3.5.ファイル同時削除同期処理](#535ファイル同時削除同期処理)
    - [5.3.6.ファイル同時編集同期処理](#536ファイル同時編集同期処理)
- [5.4.通知機能](#54通知機能)
  - [5.4.1.ユーザー通知機能](#541ユーザー通知機能)
  - [5.4.2.ユーザーレスポンス確認機能](#542ユーザーレスポンス確認機能)
  - [5.5.データ管理機能API](#55データ管理機能api)
    - [5.5.1.設定情報読み込み機能](#551設定情報読み込み機能)
    - [5.5.2.ログ書き出し機能](#552ログ書き出し機能)
    - [5.5.3.構成情報追加機能](#553構成情報追加機能)
    - [5.5.4.構成情報削除機能](#554構成情報削除機能)
    - [5.5.5.構成情報検索機能](#555構成情報検索機能)
    - [5.5.5.構成情報検索機能](#555構成情報検索機能-1)
    - [5.5.6.コンフリクト情報書き出し機能](#556コンフリクト情報書き出し機能)
    - [5.5.7.コンフリクト情報読み込み機能](#557コンフリクト情報読み込み機能)
  - [5.6.コマンド操作機能](#56コマンド操作機能)
  - [5.6.0.クラス定義](#560クラス定義)
    - [5.6.1.ファイル複製機能](#561ファイル複製機能)
    - [5.6.2.ファイル削除機能](#562ファイル削除機能)
    - [5.6.3.フォルダー追加機能](#563フォルダー追加機能)
    - [5.6.4.フォルダー削除機能](#564フォルダー削除機能)
    - [5.6.5.フォルダーパス変更機能](#565フォルダーパス変更機能)
    - [5.6.6.ファイル検索機能](#566ファイル検索機能)
    - [5.6.7.ファイルハッシュ値取得機能](#567ファイルハッシュ値取得機能)
    - [5.6.8.ファイルリスト取得機能](#568ファイルリスト取得機能)

<div style="page-break-before:always"></div>

# 1.システム概要

## 1.1 実行環境
以下に実行環境を示す。

|項目|プロダクト名|説明・制約など|
|:-|:-|:-|
|サーバー   |サーバーマシン       |下記プロダクトを実行可能で、ユーザーからのアクセスに対し十分な処理能力を有するもの。WindowsOS|
|^          |ファイルシステム     |1.2TBの利用可能な容量があること。shellコマンドからのファイル・フォルダの追加・削除を許可する。|
|^          |Python              |Python 3の実行環境があること|
|^          |shell              |次の処理をアプリケーションから呼び出すことができること。・ファイルの削除・ファイルのコピー・ファイルの追加・フォルダの作成・フォルダのリネーム・フォルダの削除・ファイルパスの取得|
|^          |toast              |アプリケーションからOSの通知を呼び出すことができるもの|
|クライアント|クライアントマシン|下記プロダクトを実行可能で、ユーザーからのアクセスに対し十分な処理能力を有するもの。|
|^          |ファイルシステム|1TBの利用可能な容量があること|
|^          |samba|リポジトリを共有してサーバーから操作できる状態であること|
|通信|LAN|1Mbpsのトランザクションを処理できること|


# 2.システム設計

# 2.1.システム構成図
@import "図表/システム構成図.puml"

### 機能一覧
|機能名|略称|説明|
|:-|:-|:-|
|管理機能|MANAGEMENT|各機能の呼び出し、結合を管理する機能|
|リポジトリ管理機能|REPOSITORY|リポジトリを管理する機能。リポジトリのパスや変更履歴の取得など|
|構成情報管理機能|COMPOSITION|構成情報を管理する機能。走査による構成情報の取得、構成情報ファイルの読み書き。|
|変更履歴管理機能|COMPOSITION_DIFF|構成情報の差分を管理する機能。ファイル情報を追加、削除、変更に分けて管理。変更履歴ファイル、リポジトリ差分ファイルの読み書き。|
|マージ機能|MERGER|リポジトリの同期処理を実行する機能。|
|ファイル操作機能|FILEOPERATER|リポジトリ内のファイルを直接操作する機能。操作の履歴をログに保存する。|


# 3. 機能設計
## 3.1 ユースケース検討
ファイルへの操作を定義し、その検出方法及びその場合に期待される処理を検討する
### 3.1.1 ファイルへの操作
ファイルに対する操作は以下の4種類に区分される。
ファイルに対するそれぞれの操作はソフト内でリポジトリのファイルと構成情報を比較することで検知する。
|操作|概要|検出方法|
|:-:|:-:|:-:|
|操作なし|ファイルに対して何も操作しない|リポジトリのファイルパス、キャッシュの値が構成情報と合致する|
|追加|新たにファイルを追加する|構成情報に存在しないパスのファイルがリポジトリ上に存在する|
|削除|既存のファイルを削除する|構成情報に存在するパスのファイルがリポジトリ上に存在しない|
|編集|既存のファイルの中身を変化させる|リポジトリ上のファイルパスが講師情報に存在するがキャッシュ値が異なる|

### 3.1.2 ファイル操作の組み合わせ
サーバーリポジトリ上のファイルとクライアントリポジトリ上のファイルそれぞれに対してファイル操作が想定される。
ファイル操作のすべての組み合わせに対して、ユースケースとしてありうるか、コンフリクトが発生するかという観点で以下のようにまとめられる。
|ファイルの操作||ユースケース||同期処理||コンフリクト||
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|サーバー|クライアント|発生有無<br>○：発生する<br>×:発生しない|識別名|発生有無<br>○:発生する<br>△：場合により発生する<br>×:発生しない<br>-:ユースケースなし|識別名|発生有無<br>○:発生する<br>△：場合により発生する<br>×:発生しない<br>-:ユースケースなし|識別名|
|操作なし|操作なし|○|Non|×|-|×|-|
|追加|操作なし|○|Add|○|SYNC_A|×|-|
|削除|操作なし|○|Del|○|SYNC_D|×|-|
|編集|操作なし|○|Edi|○|SYNC_E|×|-|
|操作なし|追加|○|Add|○|SYNC_A|×|-|
|追加|追加|○|AddAdd|△|SYNC_AA|△※|CONF_AA|
|削除|追加|×|-|-|-|-|-|
|編集|追加|×|-|-|-|-|-|
|操作なし|削除|○|Del|○|SYNC_D|×|-|
|追加|削除|×|-|-|-|-|-|
|削除|削除|○|DelDel|○|SYNC_DD|×|-|
|編集|削除|○|DelEdi|×|-|○|CONF_DE|
|操作なし|編集|○|Edi|○|SYNC_E|×|-|
|追加|編集|×|-|-|-|-|-|
|削除|編集|○|DelEdi|×|-|○|CONF_DE|
|編集|編集|○|EdiEdi|△|SYNC_EE|△※|CONF_EE|


※コンフリクト発生の条件
２つのリポジトリのファイルのキャッシュ値が異なればコンフリクト発生
キャッシュ値が同じであれば同期処理を実施する

### 3.1.3 ユースケースごとの処理

#### 3.1.3.1 ユースケースの識別
リポジトリのファイル操作を下記の通り識別する。
|識別名|操作概要|
|:-:|:-|
|Non|２つのリポジトリ内と構成情報で一貫性が保たれているまま|
|Add|片方のリポジトリに新たにファイルが追加された|
|Del|片方のリポジトリからファイルが削除された|
|Edi|片方のリポジトリのファイルが編集された(内容が変更された)|
|AddAdd|2つのリポジトリに同じパス名の同じファイルが追加された|
|AddAddC|2つのリポジトリに同じパス名の異なるファイルが追加された|
|DelDel|２つのリポジトリから同じファイルが削除された|
|DelEdi|既存のファイルを片方のリポジトリから削除され、片方のリポジトリは編集された |
|EdiEdi|２つのリポジトリのファイルが編集された(変更内容が同じ)|
|EdiEdiC|２つのリポジトリのファイルが編集された(変更内容が異なる)|

#### 3.1.3.2 同期処理
|識別名|処理内容(構成情報)|処理内容(ファイル)|
|:-:|:-:|:-|
|SYNC_A |構成情報を追加する|ファイルを追加(複製)する|
|SYNC_D |構成情報を削除する|ファイルをトラッシュフォルダに移動する|
|SYNC_E |構成情報を更新する|編集されていないリポジトリのファイルをトラッシュフォルダに移動し、対リポジトリのファイルを複製する。|
|SYNC_AA|構成情報を追加する|処理不要|
|SYNC_DD|構成情報を削除する|処理不要|
|SYNC_EE|構成情報を更新する|処理不要|


#### 3.1.3.3 コンフリクト処理
コンフリクト発生検出時はファイルはそのままにしコンフリクト情報を更新する。（参照：[4.2.2 コンフリクト情報](#422-コンフリクト情報)）

コンフリクトの解消処理は以下の表から選択する。

|識別名|処理内容|
|:-:|:-:|
|CONF_AA|サーバー側のファイルを残す|
|^      |クライアント側のファイルを残す|
|CONF_DE|ファイルを削除する|
|^      |編集されたファイルを残す|
|CONF_EE|サーバー側のファイルを残す|
|^      |クライアント側のファイルを残す|

#### 3.1.3.4 検出
リポジトリの情報とユースケースの検出の対応付けを検討する。
リポジトリの情報のインプットは下記。
・各リポジトリの変更履歴
・リポジトリ間の差分情報

##### リポジトリの変更履歴の取得
・前回の構成情報 : ファイルから読み込み
・今回の構成情報 : リポジトリを走査して取得
前回の構成情報と今回の構成情報を比較して、変更履歴を取得する。
|識別名|検出条件|
|:-|:-|
|追加|今回の構成情報のファイルパスが前回の構成情報にない|
|削除|前回の構成情報のファイルパスが今回の構成情報にない|
|変更|今回の構成情報と前回の構成情報で同じファイルパスが存在するがハッシュ値が異なる|


##### リポジトリ間の差分情報の取得
各リポジトリの今回の構成情報を取得しその差分を取得する。
|識別名|検出条件|
|:-|:-|
|追加|クライアントリポジトリ構成情報のファイルパスがサーバーリポジトリ構成情報にない|
|削除|サーバーリポジトリ構成情報のファイルパスがクライアントリポジトリ構成情報にない|
|変更|クライアントリポジトリの構成情報とサーバーリポジトリの構成情報で同じファイルパスが存在するがハッシュ値が異なる|


##### リポジトリの情報とユースケースの検出の対応付け表
|サーバーリポジトリの変更履歴|クライアントリポジトリの変更履歴|差分情報|検出されるユースケース|
|:-|:-|:-|:-|
|追加|追加|変更|AddAddC|
|追加|追加|-|AddAdd|
|追加|削除|||
|追加|変更|||
|追加|-|追加|Add|
|削除|追加|||
|削除|削除|-|DelDel|
|削除|変更|追加|DelEdi|
|削除|-|追加|Del|
|変更|追加|||
|変更|削除|削除|DelEdi|
|変更|変更|-|EdiEdi|
|変更|変更|変更|EdiEdiC|
|変更|-|変更|Edi|
|-|追加|追加|Add|
|-|削除|削除|Del|
|-|変更|変更|Edi|
|-|-|-|Non|

※1 - は変更履歴or差分情報に含まれない場合
※2　定義されない組み合わせは空白で示している

## 3.2 機能設計
全体の処理フローとして大きく下記処理に分割される。
1. 検出処理
2. マージ処理
3. コンフリクト処理

各処理フローの処理概要は下記の通りである。

##### フローチャート
@import "図表/アクテビティ図_処理フロー.puml"

### 3.2.1 検出処理 

### 3.2.2 マージ処理

### 3.2.3 (TBD)コンフリクト処理
コンフリクト情報を取得し、各コンフリクト情報に対して以下の処理を実行する。
@import "図表/アクテビティ図_コンフリクト処理.puml"

# 4.データ設計

## 4.1 外部ファイルサイズ制約
各ファイル、フォルダのサイズ上限を以下のように定める
|名前|種類|上限サイズ|
|:-|:-|:-|
|サーバーリポジトリ|フォルダー|1TB|
|クライアントリポジトリ|フォルダ|1TB|
|トラッシュフォルダ|フォルダ|200GB|
|設定ファイル|ファイル|1GB|
|構成情報ファイル|ファイル|32GB|
|コンフリクト情報ファイル|ファイル|32GB|
|ログファイル|ファイル|1GB|

## 4.2 データ定義
外部ファイルで扱うデータについて定める。

### 4.2.1 構成情報
構成情報では以下の情報を扱う。
|情報|形式|サイズ(上限)|説明|
|:-|:-|:-|:-|
|パス       |文字列|256バイト|リポジトリの親フォルダからファイル名までのパス|
|ハッシュ値 |文字列|16バイト|SHA256方式で取得したファイルのハッシュ値|
|サイズ     |整数|2バイト|ファイルサイズ(MB単位)|
|確認日時   |文字列|20バイト|構成情報を最後に確認した日時|

※パスの表し方　スラッシュ'/'で階層を表す。
※日時の表し方　'YYYY-MM-DD-hh-mm-ss'の形式
### 4.2.2 コンフリクト情報
コンフリクト情報で扱うデータを設計する。
コンフリクト情報では以下の情報を扱う。
|情報|形式|サイズ(上限)|説明|
|:-                                    |:-    |:-   |:-                             |
|構成情報上のパス                       |文字列|256バイト|構成情報に保持されているパス|
|構成情報上のハッシュ値                 |文字列|16バイト|構成情報に保持されているハッシュ値|
|サーバーリポジトリ上のパス※            |文字列|256バイト|サーバー上のファイルのパス|
|サーバーリポジトリ上のハッシュ値※      |文字列|16バイト|サーバー上のファイルのハッシュ値|
|クライアントリポジトリ上パス※          |文字列|256バイト|クライアント上のファイルのパス|
|クライアントリポジトリ上のハッシュ値※  |文字列|16バイト|クライアント上のファイルのハッシュ値|

※サーバー、クライアント上のファイルの情報について削除されている場合はNULL(空欄)とする。
#### 4.2.2.1 コンフリクト発生ケースとコンフリクト情報の対応
||ファイルに対する操作||コンフリクト情報の記載の有無|||
|:-:|:-:|:-:|:-:|:-:|:-:|
|識別名| サーバーの操作|クライアントの操作|構成情報上のパス|サーバーリポジトリ上のパス|クライアントリポジトリ上のパス|
|CONF_AA|追加|追加|×|〇|〇|
|CONF_DE|削除|編集|〇|×|〇|
|^|編集|削除|〇|〇|×|
|CONF_EE|編集|編集|〇|〇|〇|

〇:情報あり
×：情報なし（空欄）

### 4.2.3 設定情報
設定情報で扱うデータを設計する。
設定情報では以下の情報を扱う。
|クラス名|情報|形式|説明|
|:-|:-|:-|:-|
|ServerPath|サーバーリポジトリパス|文字列|サーバーリポジトリのOS上での絶対パス|
|ClientPath|クライアントリポジトリパス|文字列|クライアントリポジトリのOS上での絶対パス|
|CompositionFilePath|構成情報のファイルパス|文字列|構成情報ファイルのOS上での絶対パス|
|ConflictFilePath|コンフリクト情報ファイルパス|文字列|コンフリクト情報ファイルのOS上での絶対パス|

## 4.3 帳票設計
下記外部ファイルの形式、レイアウトを設計する。
1. 設定情報
2. 構成情報
3. 変更履歴
4. コンフリクト情報
5. ログ

### 4.3.1 設定情報ファイルレイアウト設計
設定情報を読み書きする外部ファイルのレイアウトを設計する。

#### 4.3.1.1 シリアライズフォーマット
yaml形式を用いる。

#### 4.3.1.2 情報の記載法
ファイルの記載方法を規定する。

    repository1_root_path: ルートパス
    repository1_repository_info_path: 構成情報ファイルのパス
    repository1_history_path: 変更履歴ファイルのパス
    repository2_root_path: ルートパス
    repository2_repository_info_path: 構成情報ファイルのパス
    repository2_history_path: 変更履歴ファイルのパス
    back_up_folder_path: バックアップフォルダのパス
    log_file_path: ログファイルのパス


### 4.3.2 構成情報ファイルレイアウト設計
構成情報を読み書きする外部ファイルのレイアウトを設計する。

#### 4.3.2.1 シリアライズフォーマット
csv形式を用いる。

#### 4.3.2.2 情報の記載法
ファイルの記載方法を規定する。

以下のように1つの構成情報を１行に記載する。
構成情報の要素をコンマ","で区切り、以下の順番で記載する。

    (ファイルパス), (ハッシュ値)

### 4.3.3 変更履歴情報ファイル
設定情報を読み書きする外部ファイルのレイアウトを設計する。

#### 4.3.3.1 シリアライズフォーマット
YAML形式を用いる

#### 4.3.3.2 情報の記載法
    Added:
      - ファイルパス1
      - ファイルパス2
    Removed:
      - ファイルパス1
      - ファイルパス2
    Change:
      - ファイルパス1
      - ファイルパス2


### 4.3.4 ログファイル
ログファイルの出力情報について設計する。
リポジトリの操作をしたログを出力する。

#### 4.3.4.1 シリアライズフォーマット
csv形式

#### 4.3.4.2 情報の記載法
    (タイムスタンプ), (操作), (srcファイルフルパス), (tgtファイルフルパス)


# 5.インターフェイス設計
それぞれの機能が提供するAPIを設計する。
API一覧
|機能名|関数名|概要|
|:-:|:-|:-|
|MNG|mng_begin|同期開始|
|DETECT|detect_repository|リポジトリの差分を検出する|
|  ^   |detect_composition|構成情報の差分を検出する|
|SYNC|sync_add|ファイルが追加されたときの同期処理を実行する|
|  ^ |sync_delete|ファイルが削除されたときの同期処理を実行する|
|  ^ |sync_edit|ファイルが編集されたときの同期処理を実行する|
|  ^ |sync_add2|ファイルが2つのリポジトリに同時に追加されたときの同期処理を実行する|
|  ^ |sync_delete2|ファイルが2つのリポジトリから同時に削除されたときの同期処理を実行する|
|  ^ |sync_edit2|ファイルが2つのリポジトリに同時に編集されたときの同期処理を実行する|
|NOTICE|notice_print|ユーザ通知機能|
|  ^   |notice_receive|ユーザーレスポンス確認機能|
|DATA|data_read_config|設定情報読み込み機能|
| ^  |data_write_log|ログ書き出し機能|
| ^  |data_write_composition|構成情報追加機能|
| ^  |data_remove_composition|構成情報削除機能|
| ^  |data_find_composition|構成情報検索機能|
| ^  |data_read_composition|構成情報読み出し機能|
| ^  |data_write_conflict|コンフリクト情報書き出し機能|
| ^  |data_read_conflict|コンフリクト情報読み込み機能|
|CMD|cmd_file_copy|ファイル複製機能|
| ^ |cmd_file_delete|ファイル削除機能|
| ^ |cmd_folder_add|フォルダー追加機能|
| ^ |cmd_folder_delete|フォルダー削除機能|
| ^ |cmd_folder_move|フォルダーパス変更機能|
| ^ |cmd_file_find|ファイル検索機能|
| ^ |cmd_file_hash|ファイルハッシュ値取得機能|
| ^ |cmd_file_list|ファイルリスト取得機能|


## 5.1.管理機能API
### 5.1.1.同期開始

|要素|内容|
|:-|:-|
|機能概要|外部から同期処理開始要求を受け付けるAPI。APIを呼び出されたとき順次同期処理、通知処理を実施する。|
|関数名|mng_begin|
|引数|none|
|戻り値|none|
|備考|-|

## 5.2.差分検出機能
### 5.2.1.リポジトリ差分検出

|要素|内容|
|:-|:-|
|機能概要|リポジトリの差分を検出する|
|関数名|detect_repository|
|引数|none|
|戻り値|none|
|備考|-|

### 5.2.2.構成情報差分検出

|要素|内容|
|:-|:-|
|機能概要|構成情報の差分を検出する|
|関数名|detect_composition|
|引数|none|
|戻り値|none|
|備考|-|

## 5.3.同期処理機能API
### 5.3.1.ファイル追加同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を追加しもう片方のリポジトリにファイルを複製する|
|関数名|sync_add|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|

### 5.3.2.ファイル削除同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を削除しもう片方のリポジトリからファイルをTRASHフォルダに移動する|
|関数名|sync_delete|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|

### 5.3.3.ファイル変更同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を変更し対リポジトリからファイルをTRASHフォルダに移動し対象のファイルを対リポジトリにコピーする|
|関数名|sync_edit|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|

### 5.3.4.ファイル同時追加同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を追加する|
|関数名|sync_add2|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|

### 5.3.5.ファイル同時削除同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を削除する|
|関数名|sync_del2|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|

### 5.3.6.ファイル同時編集同期処理

|要素|内容|
|:-|:-|
|機能概要|構成情報を変更する|
|関数名|sync_edd2|
|引数|repository|
|^   |file_path|
|戻り値|none|
|備考|-|



# 5.4.通知機能
## 5.4.1.ユーザー通知機能

T.B.D.
|要素|内容|
|:-|:-|
|機能概要|ユーザー通知を発行する|
|関数名|notice_print|
|引数||
|戻り値||
|備考|-|

## 5.4.2.ユーザーレスポンス確認機能
T.B.D.
|要素|内容|
|:-|:-|
|機能概要|notice_receive|
|関数名||
|引数||
|戻り値||
|備考|-|

## 5.5.データ管理機能API
### 5.5.1.設定情報読み込み機能

|要素|内容|
|:-|:-|
|機能概要 |設定情報ファイルから設定情報を読み出す|
|関数名   |data_read_config|
|引数     |none|
|戻り値   |設定データ|
|備考     |-|
### 5.5.2.ログ書き出し機能

|要素|内容|
|:-|:-|
|機能概要 |1つのログ情報をログファイルに書き出す。|
|関数名   |data_write_log|
|引数     |ログ情報|
|戻り値   |実行結果|
|備考     |-| 

### 5.5.3.構成情報追加機能

|要素|内容|
|:-|:-|
|機能概要 |構成情報を追加する|
|関数名   |data_write_composition|
|引数     |構成情報|
|戻り値   |実行結果|
|備考     |同じファイルパスがある場合は追加処理を実行せず、戻り値で通知する|

### 5.5.4.構成情報削除機能

|要素|内容|
|:-|:-|
|機能概要 |構成情報を削除する|
|関数名   |data_remove_composition|
|引数     |ファイルパス|
|戻り値   |実行結果|
|備考     |対象ファイルパスの構成情報がない場合はnot foundを返す|
### 5.5.5.構成情報検索機能

|要素|内容|
|:-|:-|
|機能概要 |構成情報を取得する|
|関数名   |data_read_composition|
|引数     |ファイルパス|
|戻り値   |構成情報|
|備考     |ファイルパスに一致する構成情報がある場合はその構成情報を返す。ない場合はNULLを返す|

### 5.5.5.構成情報検索機能

|要素|内容|
|:-|:-|
|機能概要 |構成情報を取得する|
|関数名   |data_read_composition|
|引数     |ファイルパス|
|戻り値   |構成情報|
|備考     |ファイルパスに一致する構成情報がある場合はその構成情報を返す。ない場合はNULLを返す|

### 5.5.6.コンフリクト情報書き出し機能

|要素|内容|
|:-|:-|
|機能概要 |コンフリクト情報を書き出す|
|関数名   |data_write_conflict|
|引数     |コンフリクト情報|
|戻り値   |実行結果|
|備考     |コンフリクト情報は1つずつ書き出す| 

### 5.5.7.コンフリクト情報読み込み機能

|要素|内容|
|:-|:-|
|機能概要 |コンフリクト情報を読み込む|
|関数名   |data_read_conflict|
|引数     |none|
|戻り値   |コンフリクト情報|
|備考     |-|


## 5.6.コマンド操作機能
## 5.6.0.クラス定義
・定義ファイル command.py
・クラス名 cmd
・プロパティ
|プロパティ名|型|内容|
|:-|:-|:-|
|server_repository_path|str|サーバリポジトリのパス|
|client_repository_path|str|クライアントリポジトリのパス|

・メゾット
初期化 
|引数|内容|
|:-|:-|
|server_repository_path|サーバリポジトリのパス(文字列)|
|client_repository_path|クライアントリポジトリのパス(文字列)|

その他 下記機能で定義

### 5.6.1.ファイル複製機能

|要素|内容|
|:-|:-|
|機能概要|ファイルを複製する|
|関数名|file_copy|
|引数|src_repository|
|^   |src_filepath|
|戻り値|std_ret|
|備考|コピー元のリポジトリ、ファイルパスを指定する|

### 5.6.2.ファイル削除機能

|要素|内容|
|:-|:-|
|機能概要|ファイルを削除する|
|関数名|file_delete|
|引数|tgt_repository|
|^   |tgt_filepath|
|戻り値|std_ret|
|備考|-|

### 5.6.3.フォルダー追加機能

|要素|内容|
|:-|:-|
|機能概要|フォルダ追加機能|
|関数名|folder_add|
|引数|tgt_repository|
|^   |tgt_folder_path|
|戻り値|std_ret|
|備考|-|

### 5.6.4.フォルダー削除機能

|要素|内容|
|:-|:-|
|機能概要|フォルダー削除機能|
|関数名|folder_delete|
|引数|tgt_repository|
|^   |tgt_folder_path|
|戻り値|std_ret|
|備考|-|

### 5.6.5.フォルダーパス変更機能

|要素|内容|
|:-|:-|
|機能概要|フォルダーを移動する|
|関数名|folder_move|
|引数|tgt_repository|
|^   |src_folder_path|
|^   |tgt_folder_path|
|戻り値|std_ret|
|備考|-|

### 5.6.6.ファイル検索機能

|要素|内容|
|:-|:-|
|機能概要|ファイルの有無を検索する|
|関数名|file_find|
|引数|tgt_repository|
|^   |tgt_file_path|
|戻り値|std_ret|
|備考|-|

### 5.6.7.ファイルハッシュ値取得機能

|要素|内容|
|:-|:-|
|機能概要|指定のファイルのハッシュ値を取得する|
|関数名|file_hash|
|引数|tgt_repository|
|^   |tgt_file_path|
|戻り値|hash_value|
|備考|ファイルパスは相対パスで渡す|

### 5.6.8.ファイルリスト取得機能

|要素|内容|
|:-|:-|
|機能概要|リポジトリのファイル一覧を取得する|
|関数名|file_list|
|引数|tgt_repository|
|戻り値|ファイル一覧の配列|
|備考|戻り値はファイルの相対パスのリストで返す|

